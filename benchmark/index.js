import x from"cli-table3";var h=class{static randomInt(r){let n=[];for(let i=0;i<r;i++)n.push(Math.floor(Math.random()*9007199254740992));return n}static descendingInt(r){let n=[];for(let i=0;i<r;i++)n.push(r-i);return n}static ascendingInt(r){let n=[];for(let i=0;i<r;i++)n.push(i);return n}static ascending3RandomExchangesInt(r){let n=[];for(let i=0;i<r;i++)n.push(i);for(let i=0;i<1;i++){let o=Math.floor(Math.random()*r),c=Math.floor(Math.random()*r),t=n[o];n[o]=n[c],n[c]=t}return n}static ascending10RandomEndInt(r){let n=[];for(let o=0;o<r;o++)n.push(o);let i=Math.max(0,r-10);for(let o=i;o<r;o++)n[o]=Math.floor(Math.random()*r);return n}static allEqualInt(r){let n=[];for(let i=0;i<r;i++)n.push(42);return n}static manyDuplicateInt(r){let n=[];for(let i=0;i<r;i++)n.push(Math.floor(Math.random()*(r/2*(Math.log(r)/Math.LN10))));return n}static someDuplicateInt(r){let n=[];for(let i=0;i<r;i++)n.push(Math.floor(Math.random()*r));return n}};var k=new Float32Array([1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9]),_=class{array;compare;length;minGallop=7;runLength;runStart;stackLength;tmpStorageLength=256;tmp;constructor(r,n){this.array=r,this.compare=n;let i=this.length=r.length;i<2*256&&(this.tmpStorageLength=i>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=i<120?5:i<1542?10:i<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}mergeAt(r,n){let i=this.compare,o=this.array,c=this.runLength,t=this.runStart,m=t[r],e=c[r],s=t[r+1],f=c[r+1];this.runLength[r]=e+f,r===n-3&&(t[r+1]=t[r+2],c[r+1]=c[r+2]),n--;let a=g(o[s],o,m,e,0,i);m+=a,e-=a,e!==0&&(f=L(o[m+e-1],o,s,f,f-1,i),f!==0&&(e<=f?this.mergeLow(m,e,s,f):this.mergeHigh(m,e,s,f)))}mergeHigh(r,n,i,o){let c=this.compare,t=this.array,m=this.tmp,e=0;for(e;e<o;e++)m[e]=t[i+e];let s=r+n-1,f=o-1,a=i+o-1,l=0,p=0;if(t[a--]=t[s--],--n===0){for(l=a-(o-1),e=0;e<o;e++)t[l+e]=m[e];return}if(o===1){for(a-=n,s-=n,p=a+1,l=s+1,e=n-1;e>=0;e--)t[p+e]=t[l+e];t[a]=m[f];return}let d=this.minGallop;for(;;){let b=0,T=0,A=!1;do if(c(m[f],t[s])<0){if(t[a--]=t[s--],b++,T=0,--n===0){A=!0;break}}else if(t[a--]=m[f--],T++,b=0,--o===1){A=!0;break}while((b|T)<d);if(A)break;do{if(b=n-g(m[f],t,r,n,n-1,c),b!==0){for(a-=b,s-=b,n-=b,p=a+1,l=s+1,e=b-1;e>=0;e--)t[p+e]=t[l+e];if(n===0){A=!0;break}}if(t[a--]=m[f--],--o===1){A=!0;break}if(T=o-L(t[s],m,0,o,o-1,c),T!==0){for(a-=T,f-=T,o-=T,p=a+1,l=f+1,e=0;e<T;e++)t[p+e]=m[l+e];if(o<=1){A=!0;break}}if(t[a--]=t[s--],--n===0){A=!0;break}d--}while(b>=7||T>=7);if(A)break;d<0&&(d=0),d+=2}if(this.minGallop=d,d<1&&(this.minGallop=1),o===1){for(a-=n,s-=n,p=a+1,l=s+1,e=n-1;e>=0;e--)t[p+e]=t[l+e];t[a]=m[f]}else{if(o===0)throw new Error("mergeHigh preconditions were not respected");for(l=a-(o-1),e=0;e<o;e++)t[l+e]=m[e]}}mergeLow(r,n,i,o){let c=this.compare,t=this.array,m=this.tmp,e=0;for(;e<n;e++)m[e]=t[r+e];let s=0,f=i,a=r;if(t[a++]=t[f++],--o===0){for(e=0;e<n;e++)t[a+e]=m[s+e];return}if(n===1){for(e=0;e<o;e++)t[a+e]=t[f+e];t[a+o]=m[s];return}let l=this.minGallop;for(;;){let p=0,d=0,b=!1;do if(c(t[f],m[s])<0){if(t[a++]=t[f++],d++,p=0,--o===0){b=!0;break}}else if(t[a++]=m[s++],p++,d=0,--n===1){b=!0;break}while((p|d)<l);if(b)break;do{if(p=g(t[f],m,s,n,0,c),p!==0){for(e=0;e<p;e++)t[a+e]=m[s+e];if(a+=p,s+=p,n-=p,n<=1){b=!0;break}}if(t[a++]=t[f++],--o===0){b=!0;break}if(d=L(m[s],t,f,o,0,c),d!==0){for(e=0;e<d;e++)t[a+e]=t[f+e];if(a+=d,f+=d,o-=d,o===0){b=!0;break}}if(t[a++]=m[s++],--n===1){b=!0;break}l--}while(p>=7||d>=7);if(b)break;l<0&&(l=0),l+=2}if(this.minGallop=l,l<1&&(this.minGallop=1),n===1){for(e=0;e<o;e++)t[a+e]=t[f+e];t[a+o]=m[s]}else{if(n===0)throw new Error("mergeLow preconditions were not respected");for(e=0;e<n;e++)t[a+e]=m[s+e]}}};function w(u,r,n=0,i=u.length){r?typeof r!="function"&&(i=n,n=r,r=N):r=N;let o=i-n;if(o<2)return u;let c=0;if(o<32)return c=D(u,n,i,r),R(u,n,i,n+c,r),u;let t=new _(u,r),m=0,e=U(o),s=t.runLength;do{if(c=D(u,n,i,r),c<e){let f=o;f>e&&(f=e),R(u,n,n+f,n+c,r),c=f}for(t.runStart[m]=n,s[m]=c,m+=1;m>1;){let f=m-2;if(f>=1&&s[f-1]<=s[f]+s[f+1]||f>=2&&s[f-2]<=s[f]+s[f-1])s[f-1]<s[f+1]&&f--;else if(s[f]>s[f+1])break;t.mergeAt(f,m--)}o-=c,n+=c}while(o!==0);for(;m>1;){let f=m-2;f>0&&s[f-1]<s[f+1]&&f--,t.mergeAt(f,m--)}return u}function N(u,r){if(u===r)return 0;if(~~u===u&&~~r===r){if(u===0||r===0)return u-r;if(u<0||r<0){if(r>=0)return-1;if(u>=0)return 1;u=-u,r=-r}let o=Math.log10(u)|0,c=Math.log10(r)|0,t=0;return o<c?(u*=k[c-o-1],r/=10,t=-1):o>c&&(r*=k[o-c-1],u/=10,t=1),u===r?t:u-r}let n=`${u}`,i=`${r}`;return n===i?0:n<i?-1:1}function R(u,r,n,i,o){for(i===r&&i++;i<n;i++){let c=u[i],t=r,m=i;for(;t<m;){let s=t+m>>>1;o(c,u[s])<0?m=s:t=s+1}let e=i-t;switch(e){case 3:u[t+3]=u[t+2];case 2:u[t+2]=u[t+1];case 1:u[t+1]=u[t];break;default:for(;e>0;)u[t+e]=u[t+e-1],e--}u[t]=c}}function L(u,r,n,i,o,c){let t=n+o,m=0,e=0,s=1,f;if(c(u,r[t])>0){for(e=i-o;s<e&&c(u,r[t+s])>0;)m=s,s=(s<<1)+1,s<=0&&(s=e);s>e&&(s=e),m+=o,s+=o}else{for(e=o+1;s<e&&c(u,r[t-s])<=0;)m=s,s=(s<<1)+1,s<=0&&(s=e);s>e&&(s=e),f=m,m=o-s,s=o-f}for(m++;m<s;)f=m+(s-m>>>1),c(u,r[n+f])>0?m=f+1:s=f;return s}function g(u,r,n,i,o,c){let t=0,m=0,e=1;if(c(u,r[n+o])<0){for(m=o+1;e<m&&c(u,r[n+o-e])<0;)t=e,e=(e<<1)+1,e<=0&&(e=m);e>m&&(e=m);let s=t;t=o-e,e=o-s}else{for(m=i-o;e<m&&c(u,r[n+o+e])>=0;)t=e,e=(e<<1)+1,e<=0&&(e=m);e>m&&(e=m),t+=o,e+=o}for(t++;t<e;){let s=t+(e-t>>>1);c(u,r[n+s])<0?e=s:t=s+1}return e}function D(u,r,n,i){let o=r+1;if(o===n)return 1;if(i(u[o++],u[r])<0){for(;o<n&&i(u[o],u[o-1])<0;)o++;for(o--;r<o;){let c=u[r];u[r++]=u[o],u[o--]=c}}else for(;o<n&&i(u[o],u[o-1])>=0;)o++;return o-r}function U(u){let r=0;for(;u>=32;)r|=u&1,u>>=1;return u+r}import y from"timsort";var I=(u,r)=>u-r,P=[10,100,1e3,1e4],$=u=>Math.floor(12e6/(u*(Math.log(u)/Math.LN10))),E=class{table;constructor(){this.table=new x({head:["ArrayType","Length","Time default","Time old","Time new","Speedup default","Speedup old"],colWidths:[30,20,10,15,20],style:{head:["cyan"]}})}runBenchmark(){let r=[{name:"randomInt",fn:h.randomInt},{name:"descendingInt",fn:h.descendingInt},{name:"ascendingInt",fn:h.ascendingInt},{name:"ascending3RandomExchangesInt",fn:h.ascending3RandomExchangesInt},{name:"ascending10RandomEndInt",fn:h.ascending10RandomEndInt},{name:"allEqualInt",fn:h.allEqualInt},{name:"manyDuplicateInt",fn:h.manyDuplicateInt},{name:"someDuplicateInt",fn:h.someDuplicateInt}];if(r.length===0){console.log("No generator methods available to process.");return}for(let{name:n,fn:i}of r)for(let o of P){console.log(`Benchmarking ${n} with length ${o}`);try{let{defaultTime:c,timsortTime:t,oldTimsortTime:m}=this.benchmarkGenerator(i,o);this.table.push([n,o.toString(),Math.floor(c).toString(),Math.floor(m).toString(),Math.floor(t).toString(),t!==0?(c/t).toFixed(2):"N/A",t!==0?(m/t).toFixed(2):"N/A"])}catch(c){console.error(`Error benchmarking ${n} with length ${o}:`,c)}}console.log(this.table.toString())}benchmarkGenerator(r,n){let i=0,o=0,c=0,t=$(n);console.log(`Running ${t} repetitions for length ${n}`);for(let m=0;m<t;m++){let e=r(n),s=e.slice(),f=e.slice();if(!Array.isArray(e)||!Array.isArray(s)||!Array.isArray(f))throw new Error(`Generator returned invalid array for length ${n}`);let a=process.hrtime();e.sort(I);let l=process.hrtime(),p=a[0]*1e9+a[1],d=l[0]*1e9+l[1];i+=d-p;let b=process.hrtime();w(s,I);let T=process.hrtime(),A=b[0]*1e9+b[1],S=T[0]*1e9+T[1];o+=S-A;let M=process.hrtime();y(f,I);let G=process.hrtime(),O=M[0]*1e9+M[1],F=G[0]*1e9+G[1];c+=F-O}return{defaultTime:i/t,timsortTime:o/t,oldTimsortTime:c/t}}getDefaultResults(){return this.defaultResults}getTimsortResults(){return this.timsortResults}getOldTimsortResults(){return this.oldTimsortResults}};console.log("Starting benchmark...");var H=new E;H.runBenchmark();console.log("Benchmark completed.");
