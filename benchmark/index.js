import P from"cli-table3";var w=class{static randomInt(o){let r=[];for(let u=0;u<o;u++)r.push(Math.floor(Math.random()*9007199254740992));return r}static descendingInt(o){let r=[];for(let u=0;u<o;u++)r.push(o-u);return r}static ascendingInt(o){let r=[];for(let u=0;u<o;u++)r.push(u);return r}static ascending3RandomExchangesInt(o){let r=[];for(let u=0;u<o;u++)r.push(u);for(let u=0;u<1;u++){let n=Math.floor(Math.random()*o),c=Math.floor(Math.random()*o),f=r[n];r[n]=r[c],r[c]=f}return r}static ascending10RandomEndInt(o){let r=[];for(let n=0;n<o;n++)r.push(n);let u=Math.max(0,o-10);for(let n=u;n<o;n++)r[n]=Math.floor(Math.random()*o);return r}static allEqualInt(o){let r=[];for(let u=0;u<o;u++)r.push(42);return r}static manyDuplicateInt(o){let r=[];for(let u=0;u<o;u++)r.push(Math.floor(Math.random()*(o/2*(Math.log(o)/Math.LN10))));return r}static someDuplicateInt(o){let r=[];for(let u=0;u<o;u++)r.push(Math.floor(Math.random()*o));return r}};var k=new Float32Array([1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9]);function I(e,o=x,r=0,u=e.length){let n=u-r;if(n<2)return e;let c=0;if(n<32)return c=D(e,r,u,o),p(e,r,u,r+c,o),e;let f=e.length,i=0,t=f<120?5:f<1542?10:f<119151?19:40,s=new Array(t),m=new Array(t),T=0,l=n;for(;l>=32;)T|=l&1,l>>=1;let A=T+l,d=7,_=new Array(f<2*256?f>>1:256);do{if(c=D(e,r,u,o),c<A){let b=n;b>A&&(b=A),p(e,r,r+b,r+c,o),c=b}for(s[i]=r,m[i]=c,i+=1;i>1;){let b=i-2;if(b>=1&&m[b-1]<=m[b]+m[b+1]||b>=2&&m[b-2]<=m[b]+m[b-1])m[b-1]<m[b+1]&&b--;else if(m[b]>m[b+1])break;d=O(e,o,_,b,i--,m,s,d)}n-=c,r+=c}while(n!==0);for(;i>1;){let b=i-2;b>0&&m[b-1]<m[b+1]&&b--,d=O(e,o,_,b,i--,m,s,d)}return e}function x(e,o){if(e===o)return 0;if(~~e===e&&~~o===o){if(e===0||o===0)return e-o;if(e<0||o<0){if(o>=0)return-1;if(e>=0)return 1;e=-e,o=-o}let n=Math.log10(e)|0,c=Math.log10(o)|0,f=0;return n<c?(e*=k[c-n-1],o/=10,f=-1):n>c&&(o*=k[n-c-1],e/=10,f=1),e===o?f:e-o}let r=`${e}`,u=`${o}`;return r===u?0:r<u?-1:1}function p(e,o,r,u,n){u===o&&u++;let c;for(;u<r;u++){let f=e[u],i=o,t=u;for(;i<t;)c=i+t>>1,n(f,e[c])<0?t=c:i=c+1;switch(c=u-i,c){case 3:e[i+3]=e[i+2];case 2:e[i+2]=e[i+1];case 1:e[i+1]=e[i];break;default:for(;c>0;)e[i+c]=e[i+c-1],c--}e[i]=f}}function E(e,o,r,u,n,c){let f=r+n,i=0,t=0,s=1,m;if(c(e,o[f])>0){for(t=u-n;s<t&&c(e,o[f+s])>0;)i=s,s=(s<<1)+1;s>t&&(s=t),i+=n,s+=n}else{for(t=n+1;s<t&&c(e,o[f-s])<=0;)i=s,s=(s<<1)+1;s>t&&(s=t),m=i,i=n-s,s=n-m}for(i++;i<s;)m=i+(s-i>>>1),c(e,o[r+m])>0?i=m+1:s=m;return s}function M(e,o,r,u,n,c){let f=r+n,i=0,t=0,s=1,m;if(c(e,o[f])<0){for(t=n+1;s<t&&c(e,o[f-s])<0;)i=s,s=(s<<1)+1;s>t&&(s=t),m=i,i=n-s,s=n-m}else{for(t=u-n;s<t&&c(e,o[f+s])>=0;)i=s,s=(s<<1)+1;s>t&&(s=t),i+=n,s+=n}for(i++;i<s;)m=i+(s-i>>>1),c(e,o[r+m])<0?s=m:i=m+1;return s}function D(e,o,r,u){let n=o+1;if(n===r)return 1;if(u(e[n++],e[o])<0){for(;n<r&&u(e[n],e[n-1])<0;)n++;for(n--;o<n;){let c=e[o];e[o++]=e[n],e[n--]=c}n++}else for(;n<r&&u(e[n],e[n-1])>=0;)n++;return n-o}function O(e,o,r,u,n,c,f,i){let t=f[u],s=c[u],m=f[u+1],T=c[u+1];c[u]=s+T,u===n-3&&(f[u+1]=f[u+2],c[u+1]=c[u+2]);let l=M(e[m],e,t,s,0,o);return t+=l,s-=l,s===0||(T=E(e[t+s-1],e,m,T,T-1,o),T===0)?i:s<=T?C(e,o,r,t,s,m,T,i):U(e,o,r,t,s,m,T,i)}function U(e,o,r,u,n,c,f,i){let t=0;for(t;t<f;t++)r[t]=e[c+t];let s=u+n-1,m=f-1,T=c+f-1,l=0,A=0;if(e[T--]=e[s--],--n===0){for(l=T-(f-1),t=0;t<f;t++)e[l+t]=r[t];return i}if(f===1){for(T-=n,s-=n,A=T+1,l=s+1,t=n-1;t>=0;t--)e[A+t]=e[l+t];return e[T]=r[m],i}for(;;){let d=0,_=0,b=!1;do if(o(r[m],e[s])<0){if(e[T--]=e[s--],d++,_=0,--n===0){b=!0;break}}else if(e[T--]=r[m--],_++,d=0,--f===1){b=!0;break}while((d|_)<i);if(b)break;do{if(d=n-M(r[m],e,u,n,n-1,o),d!==0){for(T-=d,s-=d,n-=d,A=T+1,l=s+1,t=d-1;t>=0;t--)e[A+t]=e[l+t];if(n===0){b=!0;break}}if(e[T--]=r[m--],--f===1){b=!0;break}if(_=f-E(e[s],r,0,f,f-1,o),_!==0){for(T-=_,m-=_,f-=_,A=T+1,l=m+1,t=0;t<_;t++)e[A+t]=r[l+t];if(f<=1){b=!0;break}}if(e[T--]=e[s--],--n===0){b=!0;break}i--}while(d>=7||_>=7);if(b)break;i=i<0?0:i+2}if(i<1&&(i=1),f===1){for(T-=n,s-=n,A=T+1,l=s+1,t=n-1;t>=0;t--)e[A+t]=e[l+t];e[T]=r[m]}else{if(f===0)throw new Error("mergeHigh preconditions were not respected");for(l=T-(f-1),t=0;t<f;t++)e[l+t]=r[t]}return i}function C(e,o,r,u,n,c,f,i){let t=0;for(;t<n;t++)r[t]=e[u+t];let s=0,m=c,T=u;if(e[T++]=e[m++],--f===0){for(t=0;t<n;t++)e[T+t]=r[s+t];return i}if(n===1){for(t=0;t<f;t++)e[T+t]=e[m+t];return e[T+f]=r[s],i}for(;;){let l=0,A=0,d=!1;do if(o(e[m],r[s])<0){if(e[T++]=e[m++],A++,l=0,--f===0){d=!0;break}}else if(e[T++]=r[s++],l++,A=0,--n===1){d=!0;break}while((l|A)<i);if(d)break;do{if(l=M(e[m],r,s,n,0,o),l!==0){for(t=0;t<l;t++)e[T+t]=r[s+t];if(T+=l,s+=l,n-=l,n<=1){d=!0;break}}if(e[T++]=e[m++],--f===0){d=!0;break}if(A=E(r[s],e,m,f,0,o),A!==0){for(t=0;t<A;t++)e[T+t]=e[m+t];if(T+=A,m+=A,f-=A,f===0){d=!0;break}}if(e[T++]=r[s++],--n===1){d=!0;break}i--}while(l>=7||A>=7);if(d)break;i<0&&(i=0),i+=2}if(i<1&&(i=1),n===1){for(t=0;t<f;t++)e[T+t]=e[m+t];e[T+f]=r[s]}else{if(n===0)throw new Error("mergeLow preconditions were not respected");for(t=0;t<n;t++)e[T+t]=r[s+t]}return i}import $ from"timsort";var a=(e,o)=>e-o,H=[10,100,1e3,1e4],G=e=>Math.floor(12e6/(e*(Math.log(e)/Math.LN10))),h=class{table;constructor(){this.table=new P({head:["ArrayType","Length","Time default","Time old","Time new","Speedup default","Speedup old"],colWidths:[30,20,10,15,20],style:{head:["cyan"]}})}runBenchmark(){let o=[{name:"randomInt",fn:w.randomInt},{name:"descendingInt",fn:w.descendingInt},{name:"ascendingInt",fn:w.ascendingInt},{name:"ascending3RandomExchangesInt",fn:w.ascending3RandomExchangesInt},{name:"ascending10RandomEndInt",fn:w.ascending10RandomEndInt},{name:"allEqualInt",fn:w.allEqualInt},{name:"manyDuplicateInt",fn:w.manyDuplicateInt},{name:"someDuplicateInt",fn:w.someDuplicateInt}];if(o.length===0){console.log("No generator methods available to process.");return}for(let{name:r,fn:u}of o)for(let n of H){console.log(`Benchmarking ${r} with length ${n}`);try{let{defaultTime:c,timsortTime:f,oldTimsortTime:i}=this.benchmarkGenerator(u,n);this.table.push([r,n.toString(),Math.floor(c).toString(),Math.floor(i).toString(),Math.floor(f).toString(),f!==0?(c/f).toFixed(2):"N/A",f!==0?(i/f).toFixed(2):"N/A"])}catch(c){console.error(`Error benchmarking ${r} with length ${n}:`,c)}}console.log(this.table.toString())}benchmarkGenerator(o,r){let u=0,n=0,c=0,f=G(r);console.log(`Running ${f} repetitions for length ${r}`);for(let i=0;i<f;i++){let t=o(r),s=t.slice(),m=t.slice();if(!Array.isArray(t)||!Array.isArray(s)||!Array.isArray(m))throw new Error(`Generator returned invalid array for length ${r}`);let T=process.hrtime();t.sort(a);let l=process.hrtime(),A=T[0]*1e9+T[1],d=l[0]*1e9+l[1];u+=d-A;let _=process.hrtime();$(m,a);let b=process.hrtime(),F=_[0]*1e9+_[1],R=b[0]*1e9+b[1];c+=R-F;let L=process.hrtime();I(s,a);let N=process.hrtime(),S=L[0]*1e9+L[1],g=N[0]*1e9+N[1];n+=g-S}return{defaultTime:u/f,timsortTime:n/f,oldTimsortTime:c/f}}};console.log("Starting benchmark...");var q=new h;q.runBenchmark();console.log("Benchmark completed.");
