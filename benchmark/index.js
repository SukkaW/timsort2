import S from"cli-table3";var h=class{static randomInt(o){let r=[];for(let i=0;i<o;i++)r.push(Math.floor(Math.random()*9007199254740992));return r}static descendingInt(o){let r=[];for(let i=0;i<o;i++)r.push(o-i);return r}static ascendingInt(o){let r=[];for(let i=0;i<o;i++)r.push(i);return r}static ascending3RandomExchangesInt(o){let r=[];for(let i=0;i<o;i++)r.push(i);for(let i=0;i<1;i++){let n=Math.floor(Math.random()*o),c=Math.floor(Math.random()*o),t=r[n];r[n]=r[c],r[c]=t}return r}static ascending10RandomEndInt(o){let r=[];for(let n=0;n<o;n++)r.push(n);let i=Math.max(0,o-10);for(let n=i;n<o;n++)r[n]=Math.floor(Math.random()*o);return r}static allEqualInt(o){let r=[];for(let i=0;i<o;i++)r.push(42);return r}static manyDuplicateInt(o){let r=[];for(let i=0;i<o;i++)r.push(Math.floor(Math.random()*(o/2*(Math.log(o)/Math.LN10))));return r}static someDuplicateInt(o){let r=[];for(let i=0;i<o;i++)r.push(Math.floor(Math.random()*o));return r}};var R=new Float32Array([1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9]),I=class{array;compare;minGallop=7;tmp;constructor(o,r,i){this.array=o,this.compare=i,this.tmp=new Array(r<2*256?r>>>1:256)}mergeAt(o,r,i,n){let c=this.compare,t=this.array,u=n[o],e=i[o],m=n[o+1],a=i[o+1];i[o]=e+a,o===r-3&&(n[o+1]=n[o+2],i[o+1]=i[o+2]),r--;let f=w(t[m],t,u,e,0,c);u+=f,e-=f,e!==0&&(a=_(t[u+e-1],t,m,a,a-1,c),a!==0&&(e<=a?this.mergeLow(u,e,m,a):this.mergeHigh(u,e,m,a)))}mergeHigh(o,r,i,n){let c=this.compare,t=this.array,u=this.tmp,e=0;for(e;e<n;e++)u[e]=t[i+e];let m=o+r-1,a=n-1,f=i+n-1,b=0,l=0;if(t[f--]=t[m--],--r===0){for(b=f-(n-1),e=0;e<n;e++)t[b+e]=u[e];return}if(n===1){for(f-=r,m-=r,l=f+1,b=m+1,e=r-1;e>=0;e--)t[l+e]=t[b+e];t[f]=u[a];return}let p=this.minGallop;for(;;){let d=0,T=0,A=!1;do if(c(u[a],t[m])<0){if(t[f--]=t[m--],d++,T=0,--r===0){A=!0;break}}else if(t[f--]=u[a--],T++,d=0,--n===1){A=!0;break}while((d|T)<p);if(A)break;do{if(d=r-w(u[a],t,o,r,r-1,c),d!==0){for(f-=d,m-=d,r-=d,l=f+1,b=m+1,e=d-1;e>=0;e--)t[l+e]=t[b+e];if(r===0){A=!0;break}}if(t[f--]=u[a--],--n===1){A=!0;break}if(T=n-_(t[m],u,0,n,n-1,c),T!==0){for(f-=T,a-=T,n-=T,l=f+1,b=a+1,e=0;e<T;e++)t[l+e]=u[b+e];if(n<=1){A=!0;break}}if(t[f--]=t[m--],--r===0){A=!0;break}p--}while(d>=7||T>=7);if(A)break;p<0&&(p=0),p+=2}if(this.minGallop=p,p<1&&(this.minGallop=1),n===1){for(f-=r,m-=r,l=f+1,b=m+1,e=r-1;e>=0;e--)t[l+e]=t[b+e];t[f]=u[a]}else{if(n===0)throw new Error("mergeHigh preconditions were not respected");for(b=f-(n-1),e=0;e<n;e++)t[b+e]=u[e]}}mergeLow(o,r,i,n){let c=this.compare,t=this.array,u=this.tmp,e=0;for(;e<r;e++)u[e]=t[o+e];let m=0,a=i,f=o;if(t[f++]=t[a++],--n===0){for(e=0;e<r;e++)t[f+e]=u[m+e];return}if(r===1){for(e=0;e<n;e++)t[f+e]=t[a+e];t[f+n]=u[m];return}let b=this.minGallop;for(;;){let l=0,p=0,d=!1;do if(c(t[a],u[m])<0){if(t[f++]=t[a++],p++,l=0,--n===0){d=!0;break}}else if(t[f++]=u[m++],l++,p=0,--r===1){d=!0;break}while((l|p)<b);if(d)break;do{if(l=w(t[a],u,m,r,0,c),l!==0){for(e=0;e<l;e++)t[f+e]=u[m+e];if(f+=l,m+=l,r-=l,r<=1){d=!0;break}}if(t[f++]=t[a++],--n===0){d=!0;break}if(p=_(u[m],t,a,n,0,c),p!==0){for(e=0;e<p;e++)t[f+e]=t[a+e];if(f+=p,a+=p,n-=p,n===0){d=!0;break}}if(t[f++]=u[m++],--r===1){d=!0;break}b--}while(l>=7||p>=7);if(d)break;b<0&&(b=0),b+=2}if(this.minGallop=b,b<1&&(this.minGallop=1),r===1){for(e=0;e<n;e++)t[f+e]=t[a+e];t[f+n]=u[m]}else{if(r===0)throw new Error("mergeLow preconditions were not respected");for(e=0;e<r;e++)t[f+e]=u[m+e]}}};function E(s,o,r=0,i=s.length){o?typeof o!="function"&&(i=r,r=o,o=k):o=k;let n=i-r;if(n<2)return s;let c=0;if(n<32)return c=g(s,r,i,o),D(s,r,i,r+c,o),s;let t=s.length,u=new I(s,t,o),e=0,m=t<120?5:t<1542?10:t<119151?19:40,a=new Array(m),f=new Array(m),b=y(n);do{if(c=g(s,r,i,o),c<b){let l=n;l>b&&(l=b),D(s,r,r+l,r+c,o),c=l}for(a[e]=r,f[e]=c,e+=1;e>1;){let l=e-2;if(l>=1&&f[l-1]<=f[l]+f[l+1]||l>=2&&f[l-2]<=f[l]+f[l-1])f[l-1]<f[l+1]&&l--;else if(f[l]>f[l+1])break;u.mergeAt(l,e--,f,a)}n-=c,r+=c}while(n!==0);for(;e>1;){let l=e-2;l>0&&f[l-1]<f[l+1]&&l--,u.mergeAt(l,e--,f,a)}return s}function k(s,o){if(s===o)return 0;if(~~s===s&&~~o===o){if(s===0||o===0)return s-o;if(s<0||o<0){if(o>=0)return-1;if(s>=0)return 1;s=-s,o=-o}let n=Math.log10(s)|0,c=Math.log10(o)|0,t=0;return n<c?(s*=R[c-n-1],o/=10,t=-1):n>c&&(o*=R[n-c-1],s/=10,t=1),s===o?t:s-o}let r=`${s}`,i=`${o}`;return r===i?0:r<i?-1:1}function D(s,o,r,i,n){for(i===o&&i++;i<r;i++){let c=s[i],t=o,u=i;for(;t<u;){let m=t+u>>>1;n(c,s[m])<0?u=m:t=m+1}let e=i-t;switch(e){case 3:s[t+3]=s[t+2];case 2:s[t+2]=s[t+1];case 1:s[t+1]=s[t];break;default:for(;e>0;)s[t+e]=s[t+e-1],e--}s[t]=c}}function _(s,o,r,i,n,c){let t=r+n,u=0,e=0,m=1,a;if(c(s,o[t])>0){for(e=i-n;m<e&&c(s,o[t+m])>0;)u=m,m=(m<<1)+1,m<=0&&(m=e);m>e&&(m=e),u+=n,m+=n}else{for(e=n+1;m<e&&c(s,o[t-m])<=0;)u=m,m=(m<<1)+1,m<=0&&(m=e);m>e&&(m=e),a=u,u=n-m,m=n-a}for(u++;u<m;)a=u+(m-u>>>1),c(s,o[r+a])>0?u=a+1:m=a;return m}function w(s,o,r,i,n,c){let t=0,u=0,e=1;if(c(s,o[r+n])<0){for(u=n+1;e<u&&c(s,o[r+n-e])<0;)t=e,e=(e<<1)+1,e<=0&&(e=u);e>u&&(e=u);let m=t;t=n-e,e=n-m}else{for(u=i-n;e<u&&c(s,o[r+n+e])>=0;)t=e,e=(e<<1)+1,e<=0&&(e=u);e>u&&(e=u),t+=n,e+=n}for(t++;t<e;){let m=t+(e-t>>>1);c(s,o[r+m])<0?e=m:t=m+1}return e}function g(s,o,r,i){let n=o+1;if(n===r)return 1;if(i(s[n++],s[o])<0){for(;n<r&&i(s[n],s[n-1])<0;)n++;for(n--;o<n;){let c=s[o];s[o++]=s[n],s[n--]=c}n++}else for(;n<r&&i(s[n],s[n-1])>=0;)n++;return n-o}function y(s){let o=0;for(;s>=32;)o|=s&1,s>>=1;return s+o}import x from"timsort";var M=(s,o)=>s-o,P=[10,100,1e3,1e4],$=s=>Math.floor(12e6/(s*(Math.log(s)/Math.LN10))),L=class{table;constructor(){this.table=new S({head:["ArrayType","Length","Time default","Time old","Time new","Speedup default","Speedup old"],colWidths:[30,20,10,15,20],style:{head:["cyan"]}})}runBenchmark(){let o=[{name:"randomInt",fn:h.randomInt},{name:"descendingInt",fn:h.descendingInt},{name:"ascendingInt",fn:h.ascendingInt},{name:"ascending3RandomExchangesInt",fn:h.ascending3RandomExchangesInt},{name:"ascending10RandomEndInt",fn:h.ascending10RandomEndInt},{name:"allEqualInt",fn:h.allEqualInt},{name:"manyDuplicateInt",fn:h.manyDuplicateInt},{name:"someDuplicateInt",fn:h.someDuplicateInt}];if(o.length===0){console.log("No generator methods available to process.");return}for(let{name:r,fn:i}of o)for(let n of P){console.log(`Benchmarking ${r} with length ${n}`);try{let{defaultTime:c,timsortTime:t,oldTimsortTime:u}=this.benchmarkGenerator(i,n);this.table.push([r,n.toString(),Math.floor(c).toString(),Math.floor(u).toString(),Math.floor(t).toString(),t!==0?(c/t).toFixed(2):"N/A",t!==0?(u/t).toFixed(2):"N/A"])}catch(c){console.error(`Error benchmarking ${r} with length ${n}:`,c)}}console.log(this.table.toString())}benchmarkGenerator(o,r){let i=0,n=0,c=0,t=$(r);console.log(`Running ${t} repetitions for length ${r}`);for(let u=0;u<t;u++){let e=o(r),m=e.slice(),a=e.slice();if(!Array.isArray(e)||!Array.isArray(m)||!Array.isArray(a))throw new Error(`Generator returned invalid array for length ${r}`);let f=process.hrtime();e.sort(M);let b=process.hrtime(),l=f[0]*1e9+f[1],p=b[0]*1e9+b[1];i+=p-l;let d=process.hrtime();E(m,M);let T=process.hrtime(),A=d[0]*1e9+d[1],O=T[0]*1e9+T[1];n+=O-A;let G=process.hrtime();x(a,M);let N=process.hrtime(),F=G[0]*1e9+G[1],U=N[0]*1e9+N[1];c+=U-F}return{defaultTime:i/t,timsortTime:n/t,oldTimsortTime:c/t}}getDefaultResults(){return this.defaultResults}getTimsortResults(){return this.timsortResults}getOldTimsortResults(){return this.oldTimsortResults}};console.log("Starting benchmark...");var H=new L;H.runBenchmark();console.log("Benchmark completed.");
